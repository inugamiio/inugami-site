<div class="container-fluid">
    <div class="row">
        <div class="col-2  d-sm-none d-md-block">
            <inugami-aside-menu></inugami-aside-menu>
        </div>

        <div class="col-12 col-md-8">
            <section class="page-section documentation">
                <header>
                    <h1>inugami_commons_test</h1>
                    <hr/>
            
                    <div class="d-block d-md-none">
                        <inugami-commons-test-toc></inugami-commons-test-toc>
                        <hr/>
                    </div>
                </header>
            
             
                
                <!--****************************************************************************************
                ** INTRO
                ****************************************************************************************-->
                <article>
                    <div class="content">
                        <pre>
                            <code [languages]="['xml']" [highlight]="sourceCode['gav']">                      
                            </code>
                        </pre>
                        <p>
                            <a target="_blank" href="http://inugami.io/javadoc/inugami_commons_test">Link for JavaDoc</a>
                        </p>
                        
                        <p>
                            Unit tests are very important aspect in software development. 
                            Java has a lot of tools to help with unit test creation, like <a href="https://assertj.github.io/doc/" target="_blank">AssertJ</a>,
                            <a href="https://site.mockito.org/" target="_blank">Mockito</a> and others.
                        </p>

                        <p>
                            A lot of people have only the code coverage in mind. But the most important metric is the mutation coverage.
                            The mutation coverage can be computed by <a href="https://pitest.org/" target="_blank">PiTest</a> with specific maven plugin.
                        </p>

                        <p>
                            <strong>inugami_commons_test</strong> is designed to help you to improve your mutation coverage.
                        </p>
                    </div>
                </article>
            
                <!--****************************************************************************************
                ** 
                ****************************************************************************************-->
                <article>
                    <header>
                        <h2>UnitTestHelper</h2>
                    </header>
                    <div class="content">
                        

                        <doc-item title="Load and read file" [level]="3" href="inugami/inugami_commons_test#" id="load_read">
                            <doc-item title="readFileRelative" [level]="4" href="inugami/inugami_commons_test#readFileRelative" id="readFileRelative">
                                <p>
                                    Some time we need to load file in unit test. The method <strong>UnitTestHelper.readFileRelative</strong> is designed
                                    to load file present in <strong>/src/test/resources</strong>
                                </p>
                                <tips title="Tips" type="info">
                                    Intellij is pretty smart and can navigate to corresponding file by clicking on the file (CRTL+Click).
                                </tips>
                                <pre>
                                    <legend>/src/test/resources/test/UnitTestHelperFile/readFileRelative.txt</legend>
                                    <code [languages]="['java']" [highlight]="sourceCode['readFileRelativeFile']">                      
                                    </code>
                                </pre>
                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['readFileRelative']">                      
                                    </code>
                                </pre>
                            </doc-item>

                            <doc-item title="readFileIntegration" [level]="4" href="inugami/inugami_commons_test#readFileIntegration" id="readFileIntegration">
                                <p>
                                    The <strong>readFileIntegration</strong> method is the same as <strong>readFileRelative</strong>, but designed to load integration  
                                    resources presents in <strong>/src/test_it/resources</strong>
                                </p>
                                <pre>
                                    <legend>/src/test/resources/test/UnitTestHelperFile/readFileIntegration.txt</legend>
                                    <code [languages]="['java']" [highlight]="sourceCode['readFileRelativeFile']">                      
                                    </code>
                                </pre>
                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['readFileIntegration']">                      
                                    </code>
                                </pre>
                            </doc-item>


                            <doc-item title="readFile" [level]="4" href="inugami/inugami_commons_test#readFile" id="readFile">
                                <p>
                                    The <strong>readFile</strong> method is the root method to load file.  readFileRelative and readFileIntegration use the 
                                    <strong>readFile</strong> to load file content after path resolution.
                                </p>
                                <p>
                                    This method is design to load file by absolute file path. UnitTestHelper have couple of methods to load file, one 
                                    with string, and the second with File object.
                                </p>
                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['readFile']">                      
                                    </code>
                                </pre>
                            </doc-item>
                        </doc-item>



                        <doc-item title="build path" [level]="3" href="inugami/inugami_commons_test#buildpath" id="buildpath">
                                The <strong>UnitTestHelper</strong> have three methods to build path :
                                <ul>
                                    <li><strong>buildTestFilePath:</strong> to build relative resource path from /src/test/resource</li>
                                    <li><strong>buildIntegrationTestFilePath:</strong> to build relative resource path from /src/test_it/resource</li>
                                    <li><strong>buildPath:</strong> for build absolute path</li>
                                </ul>
                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['buildpath']">                      
                                    </code>
                                </pre>

                                <pre>
                                    <legend>usage</legend>
                                    <code [languages]="['java']" [highlight]="sourceCode['buildpathUsage']">                      
                                    </code>
                                </pre>
                        </doc-item>


                        <doc-item title="Load stub" [level]="3" href="inugami/inugami_commons_test#loadRelativeStub" id="loadRelativeStub">
                            <p>
                                When you use Mockito to mock DAO, it can be useful to be able to load multiple stub files. 
                            </p>
                            <p>
                                The <strong>UnitTestHelper</strong> has different methods to load and manage Mockito stubs.
                            </p>


                            <pre>
                                <legend>usage</legend>
                                <code [languages]="['java']" [highlight]="sourceCode['loadRelativeStubFiles']">                      
                                </code>

                                <code [languages]="['java']" [highlight]="sourceCode['loadRelativeStub']">                      
                                </code>
                            </pre>

                            <p>
                                Loading stub can manage <strong>Json</strong> or <strong>Yaml</strong> files to defined your stubs:
                            </p>

                            <pre>
                                <code [languages]="['javascript']" [highlight]="sourceCode['loadRelativeStubFilesJson']">                      
                                </code>
                                <code [languages]="['yaml']" [highlight]="sourceCode['loadRelativeStubFilesYaml']">                      
                                </code>
                            </pre>

                            <pre>
                                <legend>Availables methods</legend>
                                <code [languages]="['java']" [highlight]="sourceCode['loadRelativeStubMethods']">                      
                                </code>
                            </pre>


                            <p>
                                When you mock search method, we need to resolve corresponding file id with given parameters.
                                To do that you can implement an idResolver:
                            </p>
                            <pre>
                                <code [languages]="['java']" [highlight]="sourceCode['loadRelativeStubIdResolver']">                      
                                </code>
                            </pre>

                        </doc-item>


                        <doc-item title="Convert to JSON" [level]="3" href="inugami/convertToJsonMain#convertToJsonMain" id="convertToJsonMain">
                            <doc-item title="convertFromJson" [level]="4" href="inugami/inugami_commons_test#convertFromJson" id="convertFromJson">

                                <p>
                                    The <strong>convertFromJson</strong> allows to transform String or byte array as Java Object.
                                </p>
                                <pre>
                                    <code [languages]="['javascript']" [highlight]="sourceCode['convertFromJsonJson']">                      
                                    </code>
                                </pre>
                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['convertFromJsonUsage']">                      
                                    </code>
                                </pre>

                                <p>
                                    The <strong>convertFromJson</strong> use Jackson to unmarshall value.
                                </p>

                                <p>
                                    By default, convertFromJson will load resources from <strong>/src/test/resources</strong>. 
                                    Excepted for <strong>loadIntegrationJson</strong> who will load from <strong>/src/test_it/resources</strong>. 
                                </p>
                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['convertFromJsonMethods']">                      
                                    </code>
                                </pre>

                            </doc-item>
                        </doc-item>



                        <doc-item title="Asserts" [level]="3" href="inugami/inugami_commons_test#asserts" id="asserts">
                          

                            <doc-item title="assertText" [level]="4" href="inugami/inugami_commons_test#assertText" id="assertText">
                                <p>
                                    <strong>assertText</strong> is the most important feature in <strong>UnitTestHelper</strong>
                                </p>
                                <p>
                                    This method will convert the input objet to <strong>JSON</strong> and match this json with a reference. 
                                </p>

                                 <pre>
                                    <legend>Reference JSON</legend>
                                    <code [languages]="['javascript']" [highlight]="sourceCode['assertTextRef']">                      
                                    </code>
                                </pre>

                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['assertTextUsage']">                      
                                    </code>
                                </pre>

                                <div>
                                    <img src="/assets/assertTextRelative.png" alt="assertTextRelative with error" class="img-30" />
                                </div>

                                <p></p>
                                <p>
                                    Some values can be dynamics. In this case we can ignore corresponding line or override the matching implementation.
                                </p>

                                <pre>
                                    <legend>Skipping lines</legend>
                                    <code [languages]="['java']" [highlight]="sourceCode['assertTextUsageSkipLine']">                      
                                    </code>
                                </pre>

                                <pre>
                                    <legend>Using regex to match specific lines</legend>
                                    <code [languages]="['java']" [highlight]="sourceCode['assertTextUsageRegex']">                      
                                    </code>
                                </pre>



                                <pre>
                                    <code [languages]="['java']" [highlight]="sourceCode['assertTextMethods']">                      
                                    </code>
                                </pre>
                            </doc-item>
                        </doc-item>



                        <doc-item title="throwException" [level]="3" href="inugami/inugami_commons_test#throwException" id="throwException">

                            <p>
                                Testing non valid use cases in application is extremely important.
                                To do that, the <strong>UnitTestHelper</strong> have different methods.
                            </p>
                            <tips title="Tips" type="info">
                                <strong>assertThrows</strong> is also designed to verify <strong>ErrorCode</strong> produce by corresponding method.
                                For more information about error code, you can read the documentation :  <a href="inugami/inugami_api#errorCode">ErrorCode</a>
                            </tips>

                            <pre>
                                <code [languages]="['java']" [highlight]="sourceCode['assertThrowsUsage']">                      
                                </code>
                            </pre>

                            <pre>
                                <code [languages]="['java']" [highlight]="sourceCode['assertThrowsMethods']">                      
                                </code>
                            </pre>

                        </doc-item>


                    </div>
                </article>



                <!--****************************************************************************************
                ** 
                ****************************************************************************************-->
                <article>
                    <header>
                        <h2>LogTestAppender</h2>
                    </header>
                    <div class="content">
                        <p>
                            Application logs should contains all required information to resolve issues and known what's append on application process.
                        </p>
                        <p>
                            It's important to be able to test logs production. To do that, the <strong>inugami_commons_test</strong> contains the 
                            custom logback appender  <strong>LogTestAppender</strong>
                        </p>

                        <p>
                            The first step is to add <strong>inugami_commons_test</strong> and <strong>logback-classic</strong> as test dependencies :
                        </p>
                        <pre>
                            <code [languages]="['xml']" [highlight]="sourceCode['logTestAppenderDependencies']">                      
                            </code>
                        </pre>

                        <p>
                           To enable the custom inugami appender, we need to configure logback :
                        </p>
                        <pre>
                            <code [languages]="['xml']" [highlight]="sourceCode['logTestAppenderLogback']">                      
                            </code>
                        </pre>

                        <p>
                            Now, we can create a listener to intercept log production:
                        </p>
                        <pre>
                            <code [languages]="['java']" [highlight]="sourceCode['logTestAppenderUsage']">                      
                            </code>
                        </pre>

                        <p>
                            It's possible to check logs production with the <strong>assertTextRelative</strong> with a JSON reference file :
                        </p>
                        <pre>
                            <code [languages]="['java']" [highlight]="sourceCode['logTestAppenderResult']">                      
                            </code>
                        </pre>

                        <p>
                            The logs list will contains all produced logs. Each logs will contains also the MDC context to improve these generation.
                        </p>

                        <tips title="Warning" type="warn">
                            Be careful to remove listener from the logs context to reduce memory usage.  
                        </tips>
                        <br/>
                        <br/>
                        <br/>
                    </div>
                </article>
            </section>  
        </div>

        <div class="col-2">
            <div class="d-md-none d-lg-block">
                <inugami-commons-test-toc></inugami-commons-test-toc>
            </div>
        </div>
        <div class="d-block d-md-none">
            <hr/>
            <inugami-commons-test-toc></inugami-commons-test-toc>
        </div>
    </div>
</div>






<!--####################################################################################
## TOOLS
####################################################################################-->

<div class="clear"></div>